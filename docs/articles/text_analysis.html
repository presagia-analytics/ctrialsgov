<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text Analysis • ctrialsgov</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Text Analysis">
<meta property="og:description" content="ctrialsgov">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctrialsgov</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to the ctrailsgov Package</a>
    </li>
    <li>
      <a href="../articles/text_analysis.html">Text Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="text_analysis_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Text Analysis</h1>
                        <h4 class="author">Taylor Arnold</h4>
            
      
      
      <div class="hidden name"><code>text_analysis.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>To start, we will load the package and the sample dataset. The same code below can be used with the entire dataset, but may be a bit slower.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ctrialsgov</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/ctgov_load_sample.html">ctgov_load_sample</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="keywords-in-context" class="section level2">
<h2 class="hasAnchor">
<a href="#keywords-in-context" class="anchor"></a>Keywords in Context</h2>
<p>The function <code>ctgov_kwic</code> highlights all of the occurances of a term within its context (the few words before and after the term occurs). For example, if we want to show the occurances of the term “bladder” in the titles of the interventional trials we can do this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_query.html">ctgov_query</a></span><span class="op">(</span>study_type <span class="op">=</span> <span class="st">"Interventional"</span><span class="op">)</span>
<span class="fu"><a href="../reference/ctgov_kwic.html">ctgov_kwic</a></span><span class="op">(</span><span class="st">"bladder"</span>, <span class="va">z</span><span class="op">$</span><span class="va">brief_title</span><span class="op">)</span></code></pre></div>
<pre><code>## ible Local Advanved |Bladder| Cancer
## isplatin Ineligible |Bladder| Cancer Patients
## n in the Overactive |Bladder|.
## zed Muscle Invasive |Bladder| Cancer Treated With
## ed With a Selective |Bladder| Preservation Approa
## men With Overactive |Bladder|
## ality of Life After |Bladder|-Preservation Chemot
## ith Muscle-Invasive |Bladder| Cancer
## ating Patients With |Bladder| Cancer That is Adva
## on Catheter-Related |Bladder| Discomfort
## Non Muscle Invasive |Bladder| Cancer
## l Lung, Biliary and |Bladder| Cancer
## Non-Muscle-Invasive |Bladder| Cancer (NMIBC) Rela
## ogic Mapping of the |Bladder|
## r Female Overactive |Bladder|
## of Ezetimibe on Gall|bladder| Function
## RI in Patients With |Bladder| Cancer
## men With Overactive |Bladder| Syndrome and Impair
## te-Risk Superficial |Bladder| Cancer
## tment of Overactive |Bladder|
## e (DMSO) in Painful |Bladder| Syndrome/Interstiti
## tment of Overactive |Bladder| or Urge Urinary Inc
## ectrical Control of |Bladder| in Spinal Cord Inju
## Non-muscle Invasive |Bladder| Cancer</code></pre>
<p>The function also has an option to include a title along with each occurance that is printed alongside each row. Here we will print the NCT id for each trial:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_query.html">ctgov_query</a></span><span class="op">(</span>study_type <span class="op">=</span> <span class="st">"Interventional"</span><span class="op">)</span>
<span class="fu"><a href="../reference/ctgov_kwic.html">ctgov_kwic</a></span><span class="op">(</span><span class="st">"bladder"</span>, <span class="va">z</span><span class="op">$</span><span class="va">brief_title</span>, <span class="va">z</span><span class="op">$</span><span class="va">nct_id</span><span class="op">)</span></code></pre></div>
<pre><code>## [NCT04553939] ible Local Advanved |Bladder| Cancer
## [NCT04046094] isplatin Ineligible |Bladder| Cancer Patients
## [NCT04483817] n in the Overactive |Bladder|.
## [NCT03702179] zed Muscle Invasive |Bladder| Cancer Treated With
## [NCT03702179] ed With a Selective |Bladder| Preservation Approa
## [NCT04477265] men With Overactive |Bladder|
## [NCT02688348] ality of Life After |Bladder|-Preservation Chemot
## [NCT02688348] ith Muscle-Invasive |Bladder| Cancer
## [NCT02178241] ating Patients With |Bladder| Cancer That is Adva
## [NCT02228473] on Catheter-Related |Bladder| Discomfort
## [NCT02214602] Non Muscle Invasive |Bladder| Cancer
## [NCT02240238] l Lung, Biliary and |Bladder| Cancer
## [NCT04498702] Non-Muscle-Invasive |Bladder| Cancer (NMIBC) Rela
## [NCT02041442] ogic Mapping of the |Bladder|
## [NCT02701010] r Female Overactive |Bladder|
## [NCT00634140] of Ezetimibe on Gall|bladder| Function
## [NCT00938145] RI in Patients With |Bladder| Cancer
## [NCT00839969] men With Overactive |Bladder| Syndrome and Impair
## [NCT00595088] te-Risk Superficial |Bladder| Cancer
## [NCT00501267] tment of Overactive |Bladder|
## [NCT00317070] e (DMSO) in Painful |Bladder| Syndrome/Interstiti
## [NCT00174798] tment of Overactive |Bladder| or Urge Urinary Inc
## [NCT00011570] ectrical Control of |Bladder| in Spinal Cord Inju
## [NCT01149174] Non-muscle Invasive |Bladder| Cancer</code></pre>
<p>There are some other options that can be used to change the way that the output is displayed. The default (shown above) prints the results out using the <code>cat</code> function. Other options return the results as a character vector of data frame, which are useful for further post-processing. There is also a flag <code>use_color</code> that prints the term in color rather than with pipes; it looks great in a terminal or RStudio but does not display correctly when knit to HTML.</p>
</div>
<div id="tf-idf" class="section level2">
<h2 class="hasAnchor">
<a href="#tf-idf" class="anchor"></a>TF-IDF</h2>
<p>We can use a technique called term frequence-inverse document frequency (TF-IDF) to determine the most important words in a collection of of text fields. To implement this in R we will use the <code>ctgov_tfidf</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">ctrialsgov</span><span class="fu">::</span><span class="fu"><a href="../reference/ctgov_query.html">ctgov_query</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tfidf</span> <span class="op">&lt;-</span> <span class="fu">ctgov_tfidf</span><span class="op">(</span><span class="va">z</span><span class="op">$</span><span class="va">description</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tfidf</span>, n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 7,440 x 2
##      doc terms                                                     
##    &lt;int&gt; &lt;chr&gt;                                                     
##  1     0 wound|colonization|bacteria|ped|observe                   
##  2     1 co2|insufflation|surgery|surgical|instruments             
##  3     2 mask|exertion|hypoxia|oxygenation|rest                    
##  4     3 rich|platelet|plasma|centrifuge|frontal                   
##  5     4 structural|heart|indicators|nursing|nurses                
##  6     5 depleted|conditioning|donor|stem|infusion                 
##  7     6 interferes|passed|tell|molecule|binding                   
##  8     7 positions|input|four|performances|cs                      
##  9     8 dash|scfa|diet|gut|bile                                   
## 10     9 tremelimumab|durvalumab|hypofractionated|radiation|signals
## 11    10 asp8374|cemiplimab|portion|names|combination              
## 12    11 epa|exploring|behavioural|otherwise|supplement            
## 13    12 prevalence|cultures|species|diarrhea|true                 
## 14    13 peep|apnoea|immediately|ventilation|manually              
## 15    14 postnatal|appropriateness|project|wellbeing|cultural      
## 16    15 tooth|bridge|preparation|dental|prosthesis                
## 17    16 cervical|narrative|screening|grounded|culturally          
## 18    17 immigrants|problem|behavioral|stress|plus                 
## 19    18 venetoclax|dasatinib|prednisone|rituximab|philadelphia    
## 20    19 theoretical|bipolar|depressive|suggested|effect           
## 21    20 mindfulness|trainees|burnout|programs|online              
## 22    21 t2d|liraglutide|adolescents|obesity|β                     
## 23    22 tranexamic|de|bleeding|acid|evacuation                    
## 24    23 cystic|fibrosis|pregnancy|cftr|modulators                 
## 25    24 flim|specimen|lumpectomy|specimens|diseased               
## 26    25 biomechanical|match|sport|traumatic|event                 
## 27    26 rai|cirrhosis|pathophysiologic|adrenal|decompensated      
## 28    27 endarterectomy|carotid|oxygenation|regional|cerebral      
## 29    28 ct|tomography|perfusion|emission|rest                     
## 30    29 operative|elective|persistent|post|opioid                 
## # … with 7,410 more rows</code></pre>
<p>The default takes the lower case version of the terms, but (particularly with acronyms) it may be better to preserve the capitalization of the terms. Here is how we can do that in this example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfidf</span> <span class="op">&lt;-</span> <span class="fu">ctgov_tfidf</span><span class="op">(</span><span class="va">z</span><span class="op">$</span><span class="va">description</span>, tolower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tfidf</span>, n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 7,440 x 2
##      doc terms                                                     
##    &lt;int&gt; &lt;chr&gt;                                                     
##  1     0 wound|colonization|bacteria|PED|observe                   
##  2     1 CO2|insufflation|surgery|surgical|Laparoscopic            
##  3     2 mask|exertion|hypoxia|oxygenation|rest                    
##  4     3 rich|platelet|plasma|centrifuge|Easy                      
##  5     4 nursing|indicators|nurses|structural|assisted             
##  6     5 depleted|conditioning|donor|stem|infusion                 
##  7     6 passed|tell|molecule|binding|cell                         
##  8     7 positions|input|four|performances|methods                 
##  9     8 DASH|diet|bile|gut|American                               
## 10     9 tremelimumab|durvalumab|radiation|signals|immune          
## 11    10 ASP8374|cemiplimab|portion|combination|second             
## 12    11 EPA|university|exploring|behavioural|otherwise            
## 13    12 prevalence|Determination|Hospitals|cultures|diarrhea      
## 14    13 PEEP|apnoea|immediately|ventilation|manually              
## 15    14 appropriateness|postnatal|project|wellbeing|cultural      
## 16    15 tooth|bridge|preparation|dental|prosthesis                
## 17    16 cervical|screening|grounded|culturally|theory             
## 18    17 Plus|Management|behavioral|stress|Goal                    
## 19    18 prednisone|venetoclax|dasatinib|Philadelphia|lymphoblastic
## 20    19 theoretical|bipolar|depressive|suggested|effect           
## 21    20 mindfulness|trainees|burnout|programs|online              
## 22    21 T2D|Liraglutide|adolescents|obesity|β                     
## 23    22 DE|tranexamic|bleeding|acid|evacuation                    
## 24    23 cystic|fibrosis|pregnancy|CFTR|conductance                
## 25    24 FLIM|specimen|lumpectomy|specimens|diseased               
## 26    25 biomechanical|match|sport|traumatic|event                 
## 27    26 cirrhosis|decompensated|adrenal|outpatients|insufficiency 
## 28    27 Volume|Regional|Brain|cerebral|Blood                      
## 29    28 CT|perfusion|rest|tomography|CTCA                         
## 30    29 operative|elective|post|opioid|key                        
## # … with 7,410 more rows</code></pre>
<p>Any number of text fields can be passed to the <code>ctgov_tokens</code> function; all of the fields for a specific trial are pasted together and treated a single block of text.</p>
</div>
<div id="document-similarity" class="section level2">
<h2 class="hasAnchor">
<a href="#document-similarity" class="anchor"></a>Document Similarity</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#tokens &lt;- ctgov_tokens(z$description)</span>
<span class="co">#token_counts &lt;- ctgov_token_counts(tokens)</span>
<span class="co">#tfidf &lt;- ctgov_tfidf(token_counts)</span>

<span class="co">#clusters &lt;- smodels::sm_spectral_cluster(tfidf)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#z$brief_title[seq(110, 150)]</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Taylor Arnold, Michael J. Kane.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
