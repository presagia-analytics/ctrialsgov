<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text Analysis with the ctrailsgov Package • ctrialsgov</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Text Analysis with the ctrailsgov Package">
<meta property="og:description" content="ctrialsgov">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctrialsgov</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to the ctrailsgov Package</a>
    </li>
    <li>
      <a href="../articles/text_analysis.html">Text Analysis with the ctrailsgov Package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="text_analysis_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Text Analysis with the ctrailsgov Package</h1>
                        <h4 class="author">Taylor Arnold and Michael J Kane</h4>
            
      
      
      <div class="hidden name"><code>text_analysis.Rmd</code></div>

    </div>

    
    
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>To start, we will load the package and the sample dataset. The same code below can be used with the entire dataset, but may be a bit slower.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ctrialsgov</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/ctgov_load_sample.html">ctgov_load_sample</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="keywords-in-context" class="section level2">
<h2 class="hasAnchor">
<a href="#keywords-in-context" class="anchor"></a>Keywords in Context</h2>
<p>The function <code>ctgov_kwic</code> highlights all of the occurances of a term within its context (the few words before and after the term occurs). For example, if we want to show the occurances of the term “bladder” in the titles of the interventional trials we can do this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_query.html">ctgov_query</a></span><span class="op">(</span>study_type <span class="op">=</span> <span class="st">"Interventional"</span><span class="op">)</span>
<span class="fu"><a href="../reference/ctgov_kwic.html">ctgov_kwic</a></span><span class="op">(</span><span class="st">"bladder"</span>, <span class="va">z</span><span class="op">$</span><span class="va">brief_title</span><span class="op">)</span></code></pre></div>
<pre><code>## ible Local Advanved |Bladder| Cancer
## isplatin Ineligible |Bladder| Cancer Patients
## n in the Overactive |Bladder|.
## men With Overactive |Bladder|
## on Catheter-Related |Bladder| Discomfort
## Non Muscle Invasive |Bladder| Cancer
## l Lung, Biliary and |Bladder| Cancer
## Non-Muscle-Invasive |Bladder| Cancer (NMIBC) Rela
## of Ezetimibe on Gall|bladder| Function
## e (DMSO) in Painful |Bladder| Syndrome/Interstiti
## tment of Overactive |Bladder| or Urge Urinary Inc
## ectrical Control of |Bladder| in Spinal Cord Inju</code></pre>
<p>The function also has an option to include a title along with each occurance that is printed alongside each row. Here we will print the NCT id for each trial:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_query.html">ctgov_query</a></span><span class="op">(</span>study_type <span class="op">=</span> <span class="st">"Interventional"</span><span class="op">)</span>
<span class="fu"><a href="../reference/ctgov_kwic.html">ctgov_kwic</a></span><span class="op">(</span><span class="st">"bladder"</span>, <span class="va">z</span><span class="op">$</span><span class="va">brief_title</span>, <span class="va">z</span><span class="op">$</span><span class="va">nct_id</span><span class="op">)</span></code></pre></div>
<pre><code>## [NCT04553939] ible Local Advanved |Bladder| Cancer
## [NCT04046094] isplatin Ineligible |Bladder| Cancer Patients
## [NCT04483817] n in the Overactive |Bladder|.
## [NCT04477265] men With Overactive |Bladder|
## [NCT02228473] on Catheter-Related |Bladder| Discomfort
## [NCT02214602] Non Muscle Invasive |Bladder| Cancer
## [NCT02240238] l Lung, Biliary and |Bladder| Cancer
## [NCT04498702] Non-Muscle-Invasive |Bladder| Cancer (NMIBC) Rela
## [NCT00634140] of Ezetimibe on Gall|bladder| Function
## [NCT00317070] e (DMSO) in Painful |Bladder| Syndrome/Interstiti
## [NCT00174798] tment of Overactive |Bladder| or Urge Urinary Inc
## [NCT00011570] ectrical Control of |Bladder| in Spinal Cord Inju</code></pre>
<p>There are some other options that can be used to change the way that the output is displayed. The default (shown above) prints the results out using the <code>cat</code> function. Other options return the results as a character vector of data frame, which are useful for further post-processing. There is also a flag <code>use_color</code> that prints the term in color rather than with pipes; it looks great in a terminal or RStudio but does not display correctly when knit to HTML.</p>
</div>
<div id="tf-idf" class="section level2">
<h2 class="hasAnchor">
<a href="#tf-idf" class="anchor"></a>TF-IDF</h2>
<p>We can use a technique called term frequence-inverse document frequency (TF-IDF) to determine the most important words in a collection of of text fields. To implement this in R we will use the <code>ctgov_tfidf</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">ctrialsgov</span><span class="fu">::</span><span class="fu"><a href="../reference/ctgov_query.html">ctgov_query</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">tfidf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_tfidf.html">ctgov_tfidf</a></span><span class="op">(</span><span class="va">z</span><span class="op">$</span><span class="va">description</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tfidf</span>, n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3,720 × 2
##      doc terms                                                       
##    &lt;int&gt; &lt;chr&gt;                                                       
##  1     0 wound|colonization|bacteria|ped|observe                     
##  2     1 mask|exertion|hypoxia|oxygenation|rest                      
##  3     2 depleted|conditioning|donor|stem|infusion                   
##  4     3 passed|tell|molecule|binding|cell                           
##  5     4 dash|diet|gut|bile|crc                                      
##  6     5 tremelimumab|durvalumab|radiation|hypofractionated|signals  
##  7     6 portion|89zr|combination|names|second                       
##  8     7 apnoea|immediately|ventilation|manually|pressure            
##  9     8 tooth|preparation|bridge|dental|prosthesis                  
## 10     9 cervical|malawian|narrative|screening|grounded              
## 11    10 problem|behavioral|stress|plus|immigrant                    
## 12    11 mindfulness|trainees|burnout|programs|online                
## 13    12 t2d|liraglutide|obesity|adolescents|fda                     
## 14    13 specimen|lumpectomy|specimens|diseased|words                
## 15    14 biomechanical|rugby|match|sport|event                       
## 16    15 cirrhosis|adrenal|outpatients|pathophysiologic|decompensated
## 17    16 ct|tomography|perfusion|emission|rest                       
## 18    17 operative|persistent|elective|post|opioid                   
## 19    18 medication|amongst|responders|bariatric|eating              
## 20    19 asd|functioning|500|adulthood|adults                        
## 21    20 knee|injected|osteoarthritis|mild|increasing                
## 22    21 basal|carcinoma|compliance|individualized|follow            
## 23    22 mv|imt|los|op|icu                                           
## 24    23 malignancies|consultation|gastrointestinal|understand|best  
## 25    24 pcr|sore|insufflation|cuff|throat                           
## 26    25 erosive|esophagitis|healing|healed|endoscopically           
## 27    26 thrombosis|ivc|cava|vena|veins                              
## 28    27 insomnia|cbt|ms|sleep|quantity                              
## 29    28 rotator|cuff|quicker|repair|healing                         
## 30    29 diverse|t2dm|clinics|regional|sleep                         
## # … with 3,690 more rows</code></pre>
<p>The default takes the lower case version of the terms, but (particularly with acronyms) it may be better to preserve the capitalization of the terms. Here is how we can do that in this example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfidf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_tfidf.html">ctgov_tfidf</a></span><span class="op">(</span><span class="va">z</span><span class="op">$</span><span class="va">description</span>, tolower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tfidf</span>, n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3,720 × 2
##      doc terms                                                       
##    &lt;int&gt; &lt;chr&gt;                                                       
##  1     0 wound|colonization|bacteria|PED|observe                     
##  2     1 mask|exertion|hypoxia|oxygenation|rest                      
##  3     2 depleted|conditioning|donor|stem|infusion                   
##  4     3 passed|molecule|tell|cell|binding                           
##  5     4 DASH|diet|gut|bile|CRC                                      
##  6     5 durvalumab|radiation|signals|immune|liver                   
##  7     6 portion|89Zr|Administered|combination|second                
##  8     7 apnoea|immediately|ventilation|expiratory|manually          
##  9     8 tooth|preparation|bridge|dental|prosthesis                  
## 10     9 cervical|screening|Malawian|grounded|culturally             
## 11    10 Problem|Plus|Management|behavioral|stress                   
## 12    11 mindfulness|burnout|programs|online|students                
## 13    12 T2D|Liraglutide|obesity|adolescents|FDA                     
## 14    13 specimen|lumpectomy|specimens|diseased|words                
## 15    14 biomechanical|rugby|match|sport|event                       
## 16    15 cirrhosis|adrenal|outpatients|pathophysiologic|decompensated
## 17    16 CT|perfusion|rest|tomography|stress                         
## 18    17 operative|post|elective|opioid|key                          
## 19    18 medication|amongst|responders|bariatric|eating              
## 20    19 ASD|500|adulthood|adults|measures                           
## 21    20 knee|osteoarthritis|injected|mild|increasing                
## 22    21 basal|carcinoma|compliance|individualized|follow            
## 23    22 MV|LOS|IMT|op|ICU                                           
## 24    23 malignancies|consultation|gastrointestinal|understand|best  
## 25    24 sore|insufflation|throat|cuff|endotracheal                  
## 26    25 esophagitis|erosive|healing|healed|endoscopically           
## 27    26 thrombosis|IVC|cava|vena|veins                              
## 28    27 Week|insomnia|CBT|MS|TAU                                    
## 29    28 rotator|cuff|quicker|repair|healing                         
## 30    29 diverse|Determine|T2DM|Programs|Aim                         
## # … with 3,690 more rows</code></pre>
<p>We can also refine the results by including fewer rare terms. The argument <code>min_df</code> specifies the minimal proportion of documents that must contain a term for it to be returned as a keyword; the upper bound can also be specified with the argument <code>max_df</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfidf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_tfidf.html">ctgov_tfidf</a></span><span class="op">(</span><span class="va">z</span><span class="op">$</span><span class="va">description</span>, min_df <span class="op">=</span> <span class="fl">0.02</span>, max_df <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tfidf</span>, n <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3,716 × 2
##      doc terms                                              
##    &lt;int&gt; &lt;chr&gt;                                              
##  1     0 effects|sample|pilot|feasibility|open              
##  2     1 surgical|higher|use|there|evidence                 
##  3     2 cell|regimen|method|immune|called                  
##  4     3 cell|tumors|stop|safe|side                         
##  5     4 receiving|investigators|participants|level|standard
##  6     5 radiation|immune|cancer|therapy|work               
##  7     6 combination|second||dose|recommended               
##  8     7 pressure|method|general|positive|end               
##  9     8 some|significant|reported|no|therefore             
## 10     9 screening|intervention|based|cancer|prevention     
## 11    10 plus|support|i|goal|intervention                   
## 12    11 medical|increased|being|out|10                     
## 13    12 incidence|us|body|day|insulin                      
## 14    13 our|technique|analysis|results|evaluation          
## 15    14 performance|cognitive|under|changes|aims           
## 16    15 whether|determine|prevalence|setting|incidence     
## 17    16 coronary|under|assess|comparison|normal            
## 18    17 post|procedures|pain|surgical|common               
## 19    18 medication|test|weight|loss|treatments             
## 20    19 adults|measures|self|outcomes|functional           
## 21    20 increasing|moderate|doses|activity|tolerability    
## 22    21 follow|cell|up|risk|factors                        
## 23    22 pre|pulmonary|undergo|decrease|muscle              
## 24    23 best|older|multi|adults|how                        
## 25    24 postoperative|pressure|including|over|effective    
## 26    25 dose|explore|assigned|weight|doses                 
## 27    26 factors|either|without|outcomes|effectiveness      
## 28    27 cognitive|i|week|outcomes|complete                 
## 29    28 both|novel|human|better|impact                     
## 30    29 diabetes|self|adults|education|                    
## # … with 3,686 more rows</code></pre>
<p>Any number of text fields can be passed to the <code>ctgov_tokens</code> function; all of the fields for a specific trial are pasted together and treated a single block of text.</p>
</div>
<div id="document-similarity" class="section level2">
<h2 class="hasAnchor">
<a href="#document-similarity" class="anchor"></a>Document Similarity</h2>
<p>Finally, the package also provides a function for producing similarity scores based on the text fields of the studies. Here, we will produce a similarity matrix based on the description field of Interventional, Industry-sponsored, Phase 2 trials.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_query.html">ctgov_query</a></span><span class="op">(</span>
  study_type <span class="op">=</span> <span class="st">"Interventional"</span>, sponsor_type <span class="op">=</span> <span class="st">"Industry"</span>, phase <span class="op">=</span> <span class="st">"Phase 2"</span>
<span class="op">)</span>
<span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ctgov_text_similarity.html">ctgov_text_similarity</a></span><span class="op">(</span><span class="va">z</span><span class="op">$</span><span class="va">description</span>, min_df <span class="op">=</span> <span class="fl">0</span>, max_df <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 176 176</code></pre>
<p>The returned value is a square matrix with one row and one colum for each clinical trial in the set. We can use these scores to find studies that are particularly close to one another in the words used within their descriptions. Here for example we can see five studies that use similar terms in their descriptions:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">scores</span><span class="op">[</span>,<span class="fl">100</span><span class="op">]</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="va">z</span><span class="op">$</span><span class="va">brief_title</span><span class="op">[</span><span class="va">index</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] "Huperzine for Cognitive and Functional Impairment in Schizophrenia"                                                  
## [2] "Schizophrenia Study In Adults"                                                                                       
## [3] "A Study to Assess Safety and Efficacy of KarXT in Adult Patients With Schizophrenia"                                 
## [4] "A Study of GWP42003 as Adjunctive Therapy in the First Line Treatment of Schizophrenia or Related Psychotic Disorder"
## [5] "A Study to Test the Effectiveness and Safety of Fremanezumab on Patients With Fibromyalgia"</code></pre>
<p>Further post-processing can be done with the similarity scores, such as spectral clustering and dimensionality reduction.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Taylor Arnold, Michael J. Kane.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
